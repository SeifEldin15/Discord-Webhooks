<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Event Extractor</title>
    <style>
        body { padding: 20px; }
        .input-group { margin-bottom: 20px; }
        input[type="text"], input[type="file"] { width: 300px; padding: 5px; margin-right: 10px; }
        .status { margin-top: 20px; padding: 10px; }
        .success { color: green; }
        .error { color: red; }
        .processing { color: blue; }
    </style>
</head>
<body>
    <h1>Discord Event Extractor</h1>
    
    <div class="input-group">
        <input type="file" id="xlsxInput" accept=".xlsx">
        <button onclick="processXlsx()">Process XLSX</button>
    </div>

    <div class="input-group">
        <input type="text" id="discordUrl" placeholder="Enter Discord URL">
        <button onclick="scrapeDiscord()">Scrape Discord</button>
    </div>

    <div id="status"></div>

    <script>
        const { ipcRenderer } = require('electron');

        function processXlsx() {
            const fileInput = document.getElementById('xlsxInput');
            if (!fileInput.files.length) {
                showStatus('Please select an XLSX file', 'error');
                return;
            }
            const filePath = fileInput.files[0].path;
            showStatus('Processing XLSX file...', 'processing');
            ipcRenderer.send('process-xlsx', { filePath });
        }

        function scrapeDiscord() {
            const urlInput = document.getElementById('discordUrl');
            const url = urlInput.value.trim();
            if (!url) {
                showStatus('Please enter a Discord URL', 'error');
                return;
            }
            showStatus('Scraping Discord data...', 'processing');
            ipcRenderer.send('scrape-discord', { url });
        }

        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }

        ipcRenderer.on('xlsx-process-complete', (event, data) => showStatus(`Successfully processed ${data.count} links.`, 'success'));
        ipcRenderer.on('xlsx-process-error', (event, error) => showStatus(`Error: ${error}`, 'error'));
        ipcRenderer.on('discord-scrape-complete', (event, { data, savedFilePath }) => {
            showStatus(`Successfully scraped ${data.length} events. File saved to: ${savedFilePath}`, 'success');
            console.log('Scraped data:', data);
            console.log('Saved to:', savedFilePath);
        });
        ipcRenderer.on('discord-scrape-error', (event, error) => {
            showStatus(`Error: ${error}`, 'error');
        });
    </script>
</body>
</html>
